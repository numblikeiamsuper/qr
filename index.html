<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Short.io Link Manager (via corsproxy.io)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" href="data:,"><!-- Prevent favicon 404 -->
<style>
  body { font-family: sans-serif; max-width: 800px; margin: auto; padding: 1em; }
  h1 { font-size: 1.4em; }
  label { display: block; margin-top: 1em; }
  input, textarea, button { width: 100%; padding: 0.5em; margin-top: 0.3em; }
  pre { background: #f0f0f0; padding: 0.5em; overflow-x: auto; }
</style>
</head>
<body>
<h1>Short.io Link Manager (CORS Proxy)</h1>

<label>
  API Key:
  <input id="apiKey" type="password" placeholder="Enter your Short.io API key">
</label>

<label>
  Original URL:
  <input id="originalUrl" type="url" placeholder="https://example.com/page">
</label>

<label>
  Domain (e.g. 0.qwe1.gleeze.com):
  <input id="domain" type="text" value="0.qwe1.gleeze.com">
</label>

<label>
  Path (optional):
  <input id="path" type="text" placeholder="custom-alias">
</label>

<button id="createBtn">Create Link</button>

<h2>Response</h2>
<pre id="responseOutput"></pre>

<script>
(function(){
  const corsProxyBase = "https://corsproxy.io/?url=";
  
  async function createLink() {
    const apiKey = document.getElementById('apiKey').value.trim();
    const originalUrl = document.getElementById('originalUrl').value.trim();
    const domain = document.getElementById('domain').value.trim();
    const path = document.getElementById('path').value.trim();

    if (!apiKey || !originalUrl || !domain) {
      alert("Please enter API key, original URL, and domain");
      return;
    }

    // Build the *real* API endpoint we want
    const targetUrl = `https://${domain}/api/shortio/links`;
    // Wrap it with the CORS proxy
    const proxiedUrl = corsProxyBase + encodeURIComponent(targetUrl);

    const payload = {
      originalURL: originalUrl,
      domain: domain,
    };
    if (path) payload.path = path;

    try {
      const res = await fetch(proxiedUrl, {
        method: "POST",
        headers: {
          "Authorization": apiKey,
          "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
      });

      const data = await res.json();
      document.getElementById('responseOutput').textContent = JSON.stringify(data, null, 2);
    } catch (err) {
      document.getElementById('responseOutput').textContent = "Error: " + err.message;
    }
  }

  document.getElementById('createBtn').addEventListener('click', createLink);
})();
</script>

</body>
</html>
